@if (entity(); as entity) {
  <mat-sidenav-container>
    <mat-sidenav opened mode="side">
      <mat-action-list>
        <button
          mat-list-item
          (click)="selectTab('General')"
          [ngClass]="{ 'active-tab': indexString == 'General' }"
        >
          <mat-icon
            matTooltip="{{ 'Section contains required fields' | translate }}"
            [color]="generalInformationValid ? 'primary' : 'accent'"
            class="required-info"
          >
            label_important
          </mat-icon>
          {{ 'General information' | translate }}
        </button>
        <button
          mat-list-item
          (click)="selectTab('Licence')"
          [ngClass]="{ 'active-tab': indexString == 'Licence' }"
        >
          <mat-icon
            matTooltip="{{ 'Section contains required fields' | translate }}"
            [color]="licenceValid ? 'primary' : 'accent'"
            class="required-info"
          >
            label_important
          </mat-icon>
          {{ 'Licence' | translate }}
        </button>

        <button
          mat-list-item
          (click)="selectTab('Related')"
          [ngClass]="{ 'active-tab': indexString == 'Related' }"
        >
          @if (digitalEntity(); as digitalEntity) {
            <mat-icon
              matTooltip="{{ 'Section contains required fields' | translate }}"
              [color]="
                personsValid && institutionsValid && hasRightsOwner && hasContactPerson
                  ? 'primary'
                  : 'accent'
              "
              class="required-info"
            >
              label_important
            </mat-icon>
          } @else {
            <mat-icon
              matTooltip="{{
                'Section is optional, but any added elements need to be filled' | translate
              }}"
              [color]="institutionsValid ? 'primary' : 'accent'"
              class="required-info"
            >
              label
            </mat-icon>
          }
          <span>{{ 'Related persons and institutions' | translate }}</span>
        </button>

        <p class="optional-text">{{ 'Optional metadata:' | translate }}</p>
        <button
          mat-list-item
          (click)="selectTab('Dimensions')"
          [ngClass]="{ 'active-tab': indexString == 'Dimensions' }"
        >
          @if (digitalEntity(); as digitalEntity) {
            <mat-icon
              matTooltip="{{
                'Section is optional, but any added elements need to be filled' | translate
              }}"
              [color]="dimensionsValid ? 'primary' : 'accent'"
              class="required-info"
            >
              label
            </mat-icon>
            <span>{{ 'Dimensions' | translate }}</span>
          }
        </button>
        <button
          mat-list-item
          (click)="selectTab('Creation')"
          [ngClass]="{ 'active-tab': indexString == 'Creation' }"
        >
          @if (digitalEntity(); as digitalEntity) {
            <mat-icon
              matTooltip="{{
                'Section is optional, but any added elements need to be filled' | translate
              }}"
              [color]="creationValid ? 'primary' : 'accent'"
              class="required-info"
            >
              label
            </mat-icon>
            <span>{{ 'Creation' | translate }}</span>
          }
        </button>

        <button
          mat-list-item
          (click)="selectTab('Ids')"
          [ngClass]="{ 'active-tab': indexString == 'Ids' }"
        >
          <mat-icon
            matTooltip="{{
              'Section is optional, but any added elements need to be filled' | translate
            }}"
            [color]="externalIdValid ? 'primary' : 'accent'"
            class="required-info"
          >
            label
          </mat-icon>
          <span>{{ 'External Identifiers' | translate }}</span>
        </button>

        <button
          mat-list-item
          (click)="selectTab('Links')"
          [ngClass]="{ 'active-tab': indexString == 'Links' }"
        >
          <mat-icon
            matTooltip="{{
              'Section is optional, but any added elements need to be filled' | translate
            }}"
            [color]="externalLinkValid ? 'primary' : 'accent'"
            class="required-info"
          >
            label
          </mat-icon>
          <span>{{ 'External Links' | translate }}</span>
        </button>
        <button
          mat-list-item
          (click)="selectTab('References')"
          [ngClass]="{ 'active-tab': indexString == 'References' }"
        >
          <mat-icon
            matTooltip="{{
              'Section is optional, but any added elements need to be filled' | translate
            }}"
            [color]="biblioRefsValid ? 'primary' : 'accent'"
            class="required-info"
          >
            label
          </mat-icon>
          <span>{{ 'Bibliographic references' | translate }}</span>
        </button>
        <button
          mat-list-item
          (click)="selectTab('Other')"
          [ngClass]="{ 'active-tab': indexString == 'Other' }"
        >
          <mat-icon
            matTooltip="{{
              'Section is optional, but any added elements need to be filled' | translate
            }}"
            [color]="externalLinkValid ? 'primary' : 'accent'"
            class="required-info"
          >
            label
          </mat-icon>
          <span>{{ 'Other' | translate }}</span>
        </button>
        <button
          mat-list-item
          (click)="selectTab('Files')"
          [ngClass]="{ 'active-tab': indexString == 'Files' }"
        >
          <mat-icon
            matTooltip="{{
              'Section is optional, but any added elements need to be filled' | translate
            }}"
            [color]="metadataFilesValid ? 'primary' : 'accent'"
            class="required-info"
          >
            label
          </mat-icon>
          <span>{{ 'Metadata files' | translate }}</span>
        </button>
        <button
          mat-list-item
          (click)="selectTab('Physical')"
          [ngClass]="{ 'active-tab': indexString == 'Physical' }"
        >
          @if (digitalEntity(); as digitalEntity) {
            <mat-icon
              matTooltip="{{
                'Section is optional, but any added elements need to be filled' | translate
              }}"
              [color]="phyObjsValid ? 'primary' : 'accent'"
            >
              label
            </mat-icon>
            <span>{{ 'Physical object' | translate }}</span>
          }
        </button>
      </mat-action-list>
    </mat-sidenav>
    <mat-sidenav-content>
      <mat-tab-group [(selectedIndex)]="selectedTabIndex" animationDuration="0ms" dynamicHeight>
        <!-- General Information -->
        <mat-tab>
          @if (digitalEntity(); as digitalEntity) {
            <app-general
              [entity]="digitalEntity"
              (remove)="removeValueFromProperty(digitalEntity, $event)"
            />
          }
        </mat-tab>
        <!-- /General Information -->

        <!-- Licence -->
        <mat-tab>
          @if (digitalEntity(); as digitalEntity) {
            <p>
              {{
                'Select a license that fits the way other users are allowed to use it.' | translate
              }}
            </p>
            <div class="form-fields">
              <mat-radio-group class="licence-selection" [(ngModel)]="digitalEntity.licence">
                @for (licence of availableLicences; track licence) {
                  <mat-radio-button [value]="licence.title">
                    <img [src]="licence.src" [alt]="licence.title" />
                    <a
                      [href]="licence.link"
                      target="_blank"
                      referrerpolicy="no-referrer"
                      rel="noreferrer"
                      [title]="licence.link"
                      >{{ licence.description }}</a
                    >
                  </mat-radio-button>
                }
              </mat-radio-group>
            </div>
          }
        </mat-tab>
        <!-- /Licence -->

        <!-- Related persons and institutions -->
        <mat-tab>
          <div>
            <app-agents [entity]="entity"></app-agents>
          </div>
        </mat-tab>
        <!-- /Related persons and institutions-->

        <!-- Dimensions -->
        <mat-tab>
          @if (digitalEntity(); as digitalEntity) {
            <app-dimension [entity]="digitalEntity"></app-dimension>
          }
        </mat-tab>
        <!-- /Dimensions -->

        <!-- Creation -->
        <mat-tab>
          @if (digitalEntity(); as digitalEntity) {
            <app-creation [entity]="digitalEntity"></app-creation>
            <!-- <mat-divider></mat-divider> -->
            <!-- <app-creation-card [entity]="digitalEntity" (remove)="removeValueFromProperty(digitalEntity, $event)"></app-creation-card> -->
          }
        </mat-tab>
        <!-- /Creation -->

        <!-- External Identifiers -->
        <mat-tab>
          @if (digitalEntity(); as digitalEntity) {
            <app-external-ids [entity]="digitalEntity"></app-external-ids>
          }
        </mat-tab>
        <!-- /External Identifiers -->

        <!-- External Links -->
        <mat-tab>
          <app-links [entity]="entity"></app-links>
        </mat-tab>
        <!-- /External Links -->

        <!-- Bibliographic References -->
        <mat-tab>
          <app-biblio-ref [entity]="entity"></app-biblio-ref>
        </mat-tab>
        <!-- /Bibliographic References -->

        <!-- Other -->
        <mat-tab>
          <app-other [entity]="entity"></app-other>
        </mat-tab>
        <!-- /Other -->

        <!-- Metadata Files -->
        <mat-tab>
          @if (digitalEntity(); as digitalEntity) {
            <app-metadata-files [entity]="digitalEntity"></app-metadata-files>
          }
        </mat-tab>
        <!-- /Metadata Files -->

        <!-- Physical Objects -->
        <mat-tab>
          @if (digitalEntity(); as digitalEntity) {
            <app-phys-obj [entity]="digitalEntity"></app-phys-obj>
          }
        </mat-tab>

        <!-- /Physical Objects -->
      </mat-tab-group>
    </mat-sidenav-content>
  </mat-sidenav-container>
}
